local HttpService = game:GetService("HttpService")
local StarterGui = game:GetService("StarterGui")

local function showNotification(title, message)
    pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = title,
            Text = message,
            Duration = 5
        })
    end)
end

showNotification("Anti-Logger", "Blocking any shady requests...")

local dangerousDomains = {
    "discord",
    "webhooks",
    "discord",
    "discordapp",
    "webhook",
    "anti",
    "protected",
    "protected.webhook",
    "webho.ok",
    "web",
    "webhook.app"
}

local function isBlockedUrl(url)
    url = tostring(url):lower()
    for _, keyword in ipairs(dangerousDomains) do
        if url:find(keyword) then
            return true
        end
    end
    return false
end

local function handleHttpRequest(requestFunction)
    return function(args)
        local url = args.Url or args.URL or ""

        if isBlockedUrl(url) then
            showNotification("Request Blocked", "Yo, blocked a sketchy HTTP request.")

            warn("Blocked request to: " .. url)

            return nil
        end
        return requestFunction(args)
    end
end

if getfenv().request then
    local originalRequest = getfenv().request
    pcall(function()
        hookfunction(originalRequest, handleHttpRequest(originalRequest))
    end)
end

if getfenv().http_request then
    local originalHttpRequest = getfenv().http_request
    pcall(function()
        hookfunction(originalHttpRequest, handleHttpRequest(originalHttpRequest))
    end)
end

if syn and syn.request then
    local originalSynRequest = syn.request
    pcall(function()
        hookfunction(originalSynRequest, handleHttpRequest(originalSynRequest))
    end)
end

if fluxus and fluxus.request then
    local originalFluxusRequest = fluxus.request
    pcall(function()
        hookfunction(originalFluxusRequest, handleHttpRequest(originalFluxusRequest))
    end)
end

pcall(function()
    local originalRequestAsync = HttpService.RequestAsync
    hookfunction(originalRequestAsync, function(self, args)
        local url = args.Url or args.URL or ""
        if isBlockedUrl(url) then
            showNotification("Request Blocked", "Yo, blocked a sketchy HTTP request.")
            warn("Blocked request to: " .. url)
            return nil 
        end
        return originalRequestAsync(self, args)
    end)
end)
